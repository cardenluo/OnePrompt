<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç§¯æœ¨æç¤ºè¯ - æ¸…ç†ä¹±ç å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      padding: 40px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      padding: 40px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }
    h1 {
      color: #667eea;
      margin-bottom: 10px;
    }
    .subtitle {
      color: #6b7280;
      margin-bottom: 30px;
    }
    .section {
      margin-bottom: 30px;
    }
    .section h2 {
      font-size: 18px;
      margin-bottom: 15px;
      color: #374151;
    }
    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      margin-right: 10px;
    }
    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }
    .btn-danger {
      background: #ef4444;
      color: white;
    }
    .btn-danger:hover {
      background: #dc2626;
    }
    .info-box {
      background: #f3f4f6;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    .status {
      margin-top: 20px;
      padding: 15px;
      border-radius: 8px;
      display: none;
    }
    .status.success {
      background: #d1fae5;
      color: #065f46;
      display: block;
    }
    .status.error {
      background: #fee2e2;
      color: #991b1b;
      display: block;
    }
    .prompt-list {
      max-height: 400px;
      overflow-y: auto;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 10px;
    }
    .prompt-item {
      padding: 10px;
      background: #f9fafb;
      margin-bottom: 10px;
      border-radius: 6px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .prompt-info {
      flex: 1;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ”§ ç§¯æœ¨æç¤ºè¯æ¸…ç†å·¥å…·</h1>
    <p class="subtitle">æ¸…ç†å¯¼å…¥CSVæ—¶äº§ç”Ÿçš„ä¹±ç æç¤ºè¯</p>

    <div class="info-box">
      <strong>âš ï¸ ä½¿ç”¨è¯´æ˜:</strong><br>
      1. æ­¤å·¥å…·å¯ä»¥æŸ¥çœ‹å’Œæ¸…ç†æ‰€æœ‰æç¤ºè¯<br>
      2. å¦‚æœå‘ç°ä¹±ç æç¤ºè¯,å¯ä»¥å•ç‹¬åˆ é™¤æˆ–å…¨éƒ¨æ¸…ç©º<br>
      3. æ¸…ç©ºåå¯ä»¥é‡æ–°å¯¼å…¥æ­£ç¡®ç¼–ç çš„CSVæ–‡ä»¶
    </div>

    <div class="section">
      <h2>å½“å‰æç¤ºè¯åˆ—è¡¨</h2>
      <button class="btn btn-primary" onclick="loadPrompts()">ğŸ”„ åˆ·æ–°åˆ—è¡¨</button>
      <button class="btn btn-danger" onclick="clearAll()">ğŸ—‘ï¸ æ¸…ç©ºæ‰€æœ‰</button>
      <div id="prompt-list" class="prompt-list" style="margin-top: 15px;">
        <p style="color: #9ca3af;">ç‚¹å‡»"åˆ·æ–°åˆ—è¡¨"æŸ¥çœ‹æç¤ºè¯</p>
      </div>
    </div>

    <div id="status" class="status"></div>
  </div>

  <script>
    function loadPrompts() {
      chrome.storage.local.get(['prompts'], (result) => {
        const prompts = result.prompts || [];
        const listDiv = document.getElementById('prompt-list');
        
        if (prompts.length === 0) {
          listDiv.innerHTML = '<p style="color: #9ca3af;">æš‚æ— æç¤ºè¯</p>';
          return;
        }

        listDiv.innerHTML = prompts.map(prompt => `
          <div class="prompt-item">
            <div class="prompt-info">
              <strong>${escapeHtml(String(prompt.title || 'æœªå‘½å').substring(0, 50))}</strong><br>
              <small style="color: #6b7280;">
                åˆ†ç±»: ${escapeHtml(String(prompt.category || 'æ— '))} | 
                ID: ${prompt.id}
              </small>
            </div>
            <button class="btn btn-danger" onclick="deletePrompt(${prompt.id})" style="margin: 0;">åˆ é™¤</button>
          </div>
        `).join('');

        showStatus(`ğŸ“Š å…± ${prompts.length} æ¡æç¤ºè¯`, 'success');
      });
    }

    function deletePrompt(id) {
      if (!confirm('ç¡®å®šåˆ é™¤è¿™æ¡æç¤ºè¯å—?')) return;

      chrome.storage.local.get(['prompts'], (result) => {
        const prompts = result.prompts || [];
        const filtered = prompts.filter(p => p.id !== id);
        chrome.storage.local.set({ prompts: filtered }, () => {
          showStatus('âœ… åˆ é™¤æˆåŠŸ', 'success');
          loadPrompts();
        });
      });
    }

    function clearAll() {
      if (!confirm('âš ï¸ ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æç¤ºè¯å—?\n\næ­¤æ“ä½œä¸å¯æ¢å¤!')) return;
      if (!confirm('ğŸš¨ æœ€åç¡®è®¤: çœŸçš„è¦åˆ é™¤æ‰€æœ‰æç¤ºè¯å—?')) return;

      chrome.storage.local.set({ prompts: [] }, () => {
        showStatus('âœ… å·²æ¸…ç©ºæ‰€æœ‰æç¤ºè¯', 'success');
        loadPrompts();
      });
    }

    function showStatus(message, type) {
      const statusDiv = document.getElementById('status');
      statusDiv.textContent = message;
      statusDiv.className = `status ${type}`;
      
      setTimeout(() => {
        statusDiv.style.display = 'none';
      }, 3000);
    }

    function escapeHtml(str) {
      const div = document.createElement('div');
      div.textContent = str;
      return div.innerHTML;
    }

    // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨åˆ·æ–°
    window.onload = loadPrompts;
  </script>
</body>
</html>
